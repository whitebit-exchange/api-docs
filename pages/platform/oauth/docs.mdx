import { ApiEndpoint } from "@/components/api-endpoint"

# OAuth API Reference

## Authentication

### OAuth 2.0 Authorization

**Example Request:**

<ApiEndpoint method="GET" path="https://whitebit.com/auth/login?clientId=YOUR_CLIENT_ID" />

This endpoint initiates the OAuth 2.0 authorization flow for user authentication and obtaining an authorization code.

**Parameters:**

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `clientId` | string | **Yes** | Your application's client ID |

**Note:** OAuth scopes are predefined during client application setup and cannot be modified during the authorization request. The access token will include all scopes that were approved during client creation.

**Available Scopes:**
The following scopes can be requested during client setup:

| Scope | Description |
|-------|-------------|
| `general` | General API access |
| `show.userinfo` | Access to basic user information |
| `users.read` | Read user data |
| `users.email.read` | Read user email information |
| `users.kyc.read` | Read user KYC information |
| `orders.read` | Read trading orders |
| `orders.create` | Create trading orders |
| `orders.delete` | Delete trading orders |
| `balances.read` | Read account balances |
| `markets.read` | Read market information |
| `deals.read` | Read trading deals |
| `orders_history.read` | Read order history |
| `users.transactions.read` | Read user transactions |
| `users.converts.read` | Read currency conversion history |
| `users.balances.read` | Read user account balances |
| `users.orders.read` | Read user orders |
| `users.deals.read` | Read user deals |

### Get Access Token

<ApiEndpoint method="POST" path="/oauth2/token" />

This endpoint exchanges an authorization code for an access token.

**Request Headers:**

| Header | Value |
|--------|-------|
| `Content-Type` | `application/x-www-form-urlencoded` |

**Parameters:**

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `client_id` | string | **Yes** | Your application's client ID |
| `client_secret` | string | **Yes** | Your application's client secret |
| `code` | string | **Yes** | The authorization code received from the authorization endpoint |

**Response:**

```typescript
interface TokenResponse {
  access_token: string;
  expires_in: string;    // Example: "3600"
  refresh_token: string;
  scope: string;        // Example: "general"
  token_type: string;   // Example: "Bearer"
}
```

**Example Response:**
```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "expires_in": "3600",
  "refresh_token": "def50200641f3e1770...",
  "scope": "general",
  "token_type": "Bearer"
}
```

**Error Responses:**

Status 401 - Not authorized:
```json
{
  "code": 0,
  "message": "This action is unauthorized."
}
```

Status 422 - Validation errors:
```json
{
  "errors": {
    "client_id": ["validation.required"],
    "client_secret": ["validation.required"],
    "code": ["validation.required"]
  },
  "notification": null
}
```

### Refresh Access Token

<ApiEndpoint method="POST" path="/oauth2/refresh_token" />

This endpoint refreshes an expired access token using a refresh token.

**Request Headers:**

| Header | Value |
|--------|-------|
| `Content-Type` | `application/x-www-form-urlencoded` |

**Parameters:**

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `client_id` | string | **Yes** | Your application's client ID |
| `client_secret` | string | **Yes** | Your application's client secret |
| `token` | string | **Yes** | The refresh token received from the token endpoint |

**Response:**

```typescript
interface TokenResponse {
  access_token: string;
  expires_in: number;    // Example: 3600
  refresh_token: string;
  scope: string;        // Example: "general"
}
```

**Error Responses:**

Status 401 - Not authorized:
```json
{
  "code": 0,
  "message": "This action is unauthorized."
}
```

Status 422 - Validation errors:
```json
{
  "errors": {
    "client_id": ["validation.required"],
    "client_secret": ["validation.required"],
    "token": ["validation.required"]
  },
  "notification": null
}
```

## Account Endpoints

### Get Account Transactions

<ApiEndpoint method="POST" path="/api/v4/accounts/transactions" />

This endpoint retrieves a paginated list of account transactions.

**Request Headers:**

| Header | Value |
|--------|-------|
| `Authorization` | `Bearer YOUR_ACCESS_TOKEN` |
| `Content-Type` | `application/json` |

**Response:**

```typescript
interface Transaction {
  id: string;
  type: string;
  amount: string;
  currency: string;
  timestamp: number;
  status: string;
}

type TransactionsResponse = Transaction[];
```

**Example Response:**

```json
[
  {
    "id": "tx_123",
    "type": "deposit",
    "amount": "1.5",
    "currency": "BTC",
    "timestamp": 1677649200,
    "status": "completed"
  }
]
```

### Get Currency Conversions

<ApiEndpoint method="POST" path="/api/v4/accounts/converts" />

This endpoint retrieves the history of currency conversions.

**Request Headers:**

| Header | Value |
|--------|-------|
| `Authorization` | `Bearer YOUR_ACCESS_TOKEN` |
| `Content-Type` | `application/json` |

**Response:**

```typescript
interface Convert {
  id: string;
  fromCurrency: string;
  toCurrency: string;
  fromAmount: string;
  toAmount: string;
  rate: string;
  timestamp: number;
}

type ConvertsResponse = Convert[];
```

### Get Orders History

<ApiEndpoint method="POST" path="/api/v4/accounts/orders" />

This endpoint retrieves the history of trading orders.

**Request Headers:**

| Header | Value |
|--------|-------|
| `Authorization` | `Bearer YOUR_ACCESS_TOKEN` |
| `Content-Type` | `application/json` |

**Response:**

```typescript
interface Order {
  id: string;
  market: string;
  type: 'limit' | 'market' | 'stop_limit' | 'stop_market';
  side: 'buy' | 'sell';
  amount: string;
  price: string;
  status: string;
  timestamp: number;
}

type OrdersResponse = Order[];
```

### Get Executed Deals

<ApiEndpoint method="POST" path="/api/v4/accounts/deals" />

This endpoint retrieves the history of executed deals.

**Request Headers:**

| Header | Value |
|--------|-------|
| `Authorization` | `Bearer YOUR_ACCESS_TOKEN` |
| `Content-Type` | `application/json` |

**Response:**

```typescript
interface Deal {
  id: string;
  orderId: string;
  market: string;
  amount: string;
  price: string;
  fee: string;
  timestamp: number;
}

type DealsResponse = Deal[];
```

### Get Main Account Balance

<ApiEndpoint method="POST" path="/api/v4/accounts/balances/main" />

This endpoint retrieves the main account balance information.

**Request Headers:**

| Header | Value |
|--------|-------|
| `Authorization` | `Bearer YOUR_ACCESS_TOKEN` |
| `Content-Type` | `application/json` |

**Response:**

```typescript
interface MainBalance {
  total: Record<string, string>;
  available: Record<string, string>;
  reserved: Record<string, string>;
}
```

**Example Response:**

```json
{
  "total": {
    "BTC": "1.5",
    "ETH": "10.0"
  },
  "available": {
    "BTC": "1.2",
    "ETH": "8.5"
  },
  "reserved": {
    "BTC": "0.3",
    "ETH": "1.5"
  }
}
```

### Get Spot Account Balance

<ApiEndpoint method="POST" path="/api/v4/accounts/balances/spot" />

This endpoint retrieves the spot trading account balance information.

**Request Headers:**

| Header | Value |
|--------|-------|
| `Authorization` | `Bearer YOUR_ACCESS_TOKEN` |
| `Content-Type` | `application/json` |

**Response:**

```typescript
interface SpotBalance {
  total: Record<string, string>;
  available: Record<string, string>;
  reserved: Record<string, string>;
}
```
